<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, minimum-scale=1, initial-scale=1, user-scalable=yes">

    <title>Service Level Reporting</title>
    <meta name="description" content="Service Level reports tool to manage Objectives, Indicators and Reports">

    <link rel="manifest" href="/manifest.json">

    <script src="/bower_components/webcomponentsjs/webcomponents-loader.js"></script>

    <link rel="import" href="/src/slr-app.html">

    <style>

      body {
        margin: 0;
        font-family: 'Roboto', 'Noto', sans-serif;
        font-size: 13px;
        line-height: 1.5;
        min-height: 100vh;
        background-color: #f5f5f5;
      }
    </style>

    <!-- Lightstep EUM -->
    <script src="/lib/opentracing/opentracing-browser.min.js"></script>
    <script src="/lib/lightstep/lightstep-tracer.js"></script>
    <script>
      let config = null
      let xmlHttp = new XMLHttpRequest()

      function onLoad() {
        try {
          config = JSON.parse(this.responseText).opentracing
        } catch(e) {
          console.log('Failed loading OpenTracing configuration')
        }

        if (config.enable) {
          initOpenTracing()
        }
      }

      let initOpenTracing = () => {
        opentracing.initGlobalTracer(new lightstep.Tracer({
          access_token: config.accessToken,
          component_name: 'SLR UI',
          xhr_instrumentation: true,
          collector_host: config.collectorHost,
          collector_port: config.collectorPort,
          verbosity: 3
        }));
        console.log('Initialized OpenTracing', opentracing, config)
      }

      xmlHttp.addEventListener("load", onLoad)
      xmlHttp.open('GET', '/config.json', false)
      xmlHttp.send()
    </script>
  </head>
  <body>
    <slr-app></slr-app>
  </body>
</html>
